(function(e){function t(t){for(var n,s,i=t[0],c=t[1],l=t[2],d=0,p=[];d<i.length;d++)s=i[d],Object.prototype.hasOwnProperty.call(o,s)&&o[s]&&p.push(o[s][0]),o[s]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(e[n]=c[n]);u&&u(t);while(p.length)p.shift()();return r.push.apply(r,l||[]),a()}function a(){for(var e,t=0;t<r.length;t++){for(var a=r[t],n=!0,i=1;i<a.length;i++){var c=a[i];0!==o[c]&&(n=!1)}n&&(r.splice(t--,1),e=s(s.s=a[0]))}return e}var n={},o={app:0},r=[];function s(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,s),a.l=!0,a.exports}s.m=e,s.c=n,s.d=function(e,t,a){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(s.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)s.d(a,n,function(t){return e[t]}.bind(null,n));return a},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],c=i.push.bind(i);i.push=t,i=i.slice();for(var l=0;l<i.length;l++)t(i[l]);var u=c;r.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"56d7":function(e,t,a){"use strict";a.r(t);a("e260"),a("e6cf"),a("cca6"),a("a79d");var n=a("2b0e"),o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-app",[a("v-main",[a("History")],1)],1)},r=[],s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",{staticStyle:{height:"80vh"}},[a("v-data-table",{staticClass:"elevation-1",attrs:{expanded:e.expanded,headers:e.headers,items:e.items,height:"80vh","item-key":"jobExecutionId","single-expand":"","sort-by":"createTime","sort-desc":""},on:{"update:expanded":function(t){e.expanded=t}},scopedSlots:e._u([{key:"item",fn:function(t){var n=t.item,o=t.expand,r=t.isExpanded;return[a("tr",[a("td",{staticClass:"text-center"},[e._v(e._s(n.jobExecutionId))]),a("td",{staticClass:"text-center"},[e._v(e._s(n.jobInstanceId.jobName))]),a("td",{staticClass:"text-center"},[e._v(e._s(n.createTime))]),a("td",{staticClass:"text-center"},[e._v(e._s(n.startTime))]),a("td",{staticClass:"text-center"},[e._v(e._s(n.endTime))]),a("td",{staticClass:"text-center"},[e._v(e._s(e.statusTranslate(n.status)))]),a("td",{staticClass:"text-center"},[e.isPurchaseConvertComplete(n.batchStepExecutions)?a("v-chip",{staticClass:"ma-1",attrs:{color:"success",label:"",outlined:""},on:{click:function(t){return t.stopPropagation(),e.downloadPurchaseOrder(n.jobExecutionId)}}},[e._v(" 다운로드 ")]):e._e()],1),a("td",{staticClass:"text-center"},[a("v-icon",{on:{click:function(e){return o(!r)}}},r?[e._v("mdi-chevron-up")]:[e._v("mdi-chevron-down")])],1)])]}},{key:"top",fn:function(){return[a("v-toolbar",{attrs:{flat:""}},[a("v-toolbar-title",[e._v("업무 자동화")]),a("v-spacer"),a("SettingDialog"),a("JobStartDialog",{on:{getHistoryList:e.getHistoryList}})],1)]},proxy:!0},{key:"expanded-item",fn:function(t){var n=t.headers,o=t.item;return[a("td",{staticClass:"pa-0",attrs:{colspan:n.length}},[a("v-stepper",{attrs:{"alt-labels":""}},[a("v-stepper-header",[e._l(e.getJobSteps(o.jobInstanceId.jobName),(function(t,n){return[a("v-stepper-step",{key:n,staticStyle:{"font-size":"14px",cursor:"pointer"},attrs:{complete:e.isStepCompleted(o.batchStepExecutions[n]),rules:[function(){return e.isStepError(o.batchStepExecutions[n])}],step:n+1},on:{click:function(t){!e.isStepError(o.batchStepExecutions[n])&&e.showCustomersError(o.batchStepExecutions[n])}}},[e._v(" "+e._s(t)+" ")]),n+1<e.getJobSteps(o.jobInstanceId.jobName).length?a("v-divider",{key:"divider-"+n}):e._e()]}))],2)],1)],1)]}}])}),a("MessageDialog")],1)},i=[],c=a("5530"),l=(a("159b"),a("7db0"),a("2f62")),u=(a("ac1f"),a("1276"),a("21a6")),d=function(e,t){var a="content-disposition",n=e.headers[a],o=void 0===n?t:n.split('"')[1];console.log("Received header ["+a+"]: "+n+", effective fileName: "+o),Object(u["saveAs"])(e.data,o)},p=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-dialog",{attrs:{width:"500"},model:{value:e.getMessageDialog.show,callback:function(t){e.$set(e.getMessageDialog,"show",t)},expression:"getMessageDialog.show"}},[a("v-card",[a("v-card-title",[e._v(e._s(e.getMessageDialog.title))]),a("v-card-text",{staticStyle:{"white-space":"pre-line"}},[e._v(" "+e._s(e.getMessageDialog.message)+" ")]),e.isCustomersDownload?a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"primary",text:""},on:{click:e.downloadUnregisteredCustomers}},[e._v(" 미등록 거래처 목록 다운로드 ")])],1):e._e()],1)],1)},g=[],f={name:"MessageDialog",computed:Object(c["a"])({},Object(l["b"])(["getMessageDialog","isCustomersDownload"])),methods:{downloadUnregisteredCustomers:function(){var e=this;this.$http.get("api/unregistered-customer/"+this.getMessageDialog.jobExecutionId,{responseType:"blob"}).then((function(e){return d(e,"미등록 거래처.xlsx")})).catch((function(t){return e.showDialog({title:"에러 상세 정보",message:t.message})}))}}},v=f,m=a("2877"),h=a("6544"),b=a.n(h),x=a("8336"),_=a("b0af"),y=a("99d9"),w=a("169a"),D=a("2fa4"),C=Object(m["a"])(v,p,g,!1,null,"27f65492",null),V=C.exports;b()(C,{VBtn:x["a"],VCard:_["a"],VCardActions:y["a"],VCardText:y["b"],VCardTitle:y["c"],VDialog:w["a"],VSpacer:D["a"]});var S=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-dialog",{attrs:{"max-width":"800px"},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,o=t.attrs;return[a("v-btn",e._g(e._b({staticClass:"ma-2 white--text",attrs:{color:"blue-grey"}},"v-btn",o,!1),n),[e._v(" 배치 설정 "),a("v-icon",{attrs:{dark:"",right:""}},[e._v("mdi-cog")])],1)]}}]),model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[a("v-card",[a("v-card-title",[a("span",{staticClass:"text-h5"},[e._v("배치 환경 설정")])]),a("v-card-text",[a("v-container",[a("v-row",[a("v-col",{attrs:{cols:"12"}},[a("v-expansion-panels",{attrs:{flat:""}},[a("v-expansion-panel",[a("v-expansion-panel-header",{staticClass:"pa-0"},[a("v-text-field",{attrs:{hint:e.cronToString(e.form.cron),label:"배치 조건","persistent-hint":"",readonly:"",required:""},model:{value:e.form.cron,callback:function(t){e.$set(e.form,"cron",t)},expression:"form.cron"}})],1),a("v-expansion-panel-content",{staticClass:"pa-0 mt-2"},[a("v-card",{staticClass:"pa-2",attrs:{outlined:"",tile:""}},[a("VueCronEditorBuefy",{attrs:{"custom-locales":e.i18n,cronSyntax:"quartz",locale:"ko",preserveStateOnSwitchToAdvanced:""},model:{value:e.form.cron,callback:function(t){e.$set(e.form,"cron",t)},expression:"form.cron"}})],1)],1)],1)],1)],1),a("v-col",{attrs:{cols:"12"}},[a("v-select",{attrs:{items:e.periodSelect,"item-text":"text","item-value":"period",label:"조회 기간",required:""},model:{value:e.form.period,callback:function(t){e.$set(e.form,"period",t)},expression:"form.period"}})],1)],1)],1)],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:e.getEnv}},[e._v(" 취소 ")]),a("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:e.saveEnv}},[e._v(" 저장 ")])],1)],1)],1)},j=[],k=(a("5319"),a("d3b7"),a("25f0"),a("dcce")),E=a.n(k),T=a("7aa9"),O=a.n(T),M={name:"SettingDialog",components:{VueCronEditorBuefy:E.a},created:function(){this.getEnv()},methods:Object(c["a"])(Object(c["a"])({},Object(l["c"])(["showDialog"])),{},{cronToString:function(e){return O.a.toString(e,{use24HourTimeFormat:!0,locale:"ko"}).replace("에서"," at ")},getEnv:function(){var e=this;this.dialog=!1,this.$http.get("api/settings/batch/auto").then((function(t){return e.form=t.data})).catch((function(t){return e.showDialog({title:"에러 상세 정보",message:t.message})}))},saveEnv:function(){var e=this;this.dialog=!1,this.$http.put("api/settings/batch",this.form).then((function(t){return e.form=t.data})).catch((function(t){return e.showDialog({title:"에러 상세 정보",message:t.message})}))}}),data:function(){return{dialog:!1,form:{type:"auto",cron:"0 10 9 ? * *",period:6},periodSelect:[{text:"하루 전",period:1},{text:"일주일 전",period:6},{text:"한달 전",period:30}],i18n:{ko:{every:"매",mminutes:"분 마다",hoursOnMinute:"시간 마다",daysAt:"일 마다",at:"에",onThe:"매",dayOfEvery:"일에",monthsAt:"개월 마다",everyDay:"매주",mon:"월",tue:"화",wed:"수",thu:"목",fri:"금",sat:"토",sun:"일",hasToBeBetween:"Has to be between",and:"and",minutes:"매분",hourly:"매시간",daily:"매일",weekly:"매주",monthly:"매월",advanced:"고급",cron:"cron 표현식 :"}}}}},P=M,$=a("62ad"),I=a("a523"),H=a("cd55"),J=a("49e2"),N=a("c865"),A=a("0393"),L=a("132d"),B=a("0fd9"),R=a("b974"),F=a("8654"),q=Object(m["a"])(P,S,j,!1,null,"98d22b78",null),z=q.exports;b()(q,{VBtn:x["a"],VCard:_["a"],VCardActions:y["a"],VCardText:y["b"],VCardTitle:y["c"],VCol:$["a"],VContainer:I["a"],VDialog:w["a"],VExpansionPanel:H["a"],VExpansionPanelContent:J["a"],VExpansionPanelHeader:N["a"],VExpansionPanels:A["a"],VIcon:L["a"],VRow:B["a"],VSelect:R["a"],VSpacer:D["a"],VTextField:F["a"]});var U=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-dialog",{attrs:{"max-width":"600px"},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,o=t.attrs;return[a("v-btn",e._g(e._b({staticClass:"ma-2 white--text",attrs:{color:"blue-grey"}},"v-btn",o,!1),n),[e.progress?a("v-progress-circular",{attrs:{indeterminate:"",color:"white"}}):[e._v(" 수동 실행 "),a("v-icon",{attrs:{dark:"",right:""}},[e._v("mdi-play")])]],2)]}}]),model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[a("v-card",[a("v-card-title",[a("span",{staticClass:"text-h5"},[e._v("수동 실행")])]),a("v-card-text",[a("v-container",[a("v-row",[a("v-col",{attrs:{cols:"12"}},[a("v-menu",{ref:"calendarMenu",attrs:{"close-on-content-click":!1,"return-value":e.dates,transition:"scale-transition","offset-y":"","min-width":"auto"},on:{"update:returnValue":function(t){e.dates=t},"update:return-value":function(t){e.dates=t}},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,o=t.attrs;return[a("v-text-field",e._g(e._b({attrs:{"prepend-icon":"mdi-calendar",label:"데이터 조회 기간",required:"",readonly:""},model:{value:e.dateRangeText,callback:function(t){e.dateRangeText=t},expression:"dateRangeText"}},"v-text-field",o,!1),n))]}}]),model:{value:e.calendarMenu,callback:function(t){e.calendarMenu=t},expression:"calendarMenu"}},[a("v-date-picker",{attrs:{"show-current":"",range:"","no-title":"",scrollable:""},on:{input:function(t){e.menu2=!1}},model:{value:e.dates,callback:function(t){e.dates=t},expression:"dates"}},[a("v-spacer"),a("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(t){e.menu=!1}}},[e._v(" 취소 ")]),a("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(t){return e.$refs.calendarMenu.save(e.dates)}}},[e._v(" 확인 ")])],1)],1)],1),a("v-col",{attrs:{cols:"12"}},[a("v-select",{attrs:{items:e.jobSelect,"item-text":"text","item-value":"api",label:"배치 종류",required:""},model:{value:e.form.api,callback:function(t){e.$set(e.form,"api",t)},expression:"form.api"}})],1)],1)],1)],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:function(t){e.dialog=!1}}},[e._v(" 취소 ")]),a("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:function(t){return e.executeJob()}}},[e._v(" 시작 ")])],1)],1)],1)},G=[],K=(a("a15b"),{name:"JobStartDialog",methods:Object(c["a"])(Object(c["a"])({},Object(l["c"])(["showDialog"])),{},{executeJob:function(){var e=this;this.dialog=!1,this.progress=!0,this.$http.post("api/run/"+this.form.api,this.getFormData()).then((function(t){console.log(t),e.progress=!1,e.$emit("getHistoryList"),e.showDialog({title:"작업 완료",message:"작업을 진행 하였습니다."}),setTimeout((function(){return e.dialog.show=!1}),5e3)})).catch((function(t){console.log(t),e.showDialog({title:"에러 상세 정보",message:t.message}),e.$emit("getHistoryList"),e.progress=!1}))},getFormData:function(){return this.form.fromDate=this.dates[0],this.form.toDate=this.dates[1],console.log(this.form),this.form}}),data:function(){return{dialog:!1,calendarMenu:!1,progress:!1,dates:[],form:{fromDate:"",toDate:"",api:""},jobSelect:[{text:"전체",api:"all"},{text:"품목 등록",api:"item"},{text:"수주 등록",api:"contract"},{text:"발주 생성",api:"purchase"},{text:"미등록 거래처 확인",api:"customer"}]}},computed:{dateRangeText:function(){return this.dates.join(" ~ ")}}}),Q=K,W=a("2e4b"),X=a("e449"),Y=a("490a"),Z=Object(m["a"])(Q,U,G,!1,null,"3d1cff9a",null),ee=Z.exports;b()(Z,{VBtn:x["a"],VCard:_["a"],VCardActions:y["a"],VCardText:y["b"],VCardTitle:y["c"],VCol:$["a"],VContainer:I["a"],VDatePicker:W["a"],VDialog:w["a"],VIcon:L["a"],VMenu:X["a"],VProgressCircular:Y["a"],VRow:B["a"],VSelect:R["a"],VSpacer:D["a"],VTextField:F["a"]});var te={name:"History",components:{MessageDialog:V,SettingDialog:z,JobStartDialog:ee},mounted:function(){this.getHistoryList()},methods:Object(c["a"])(Object(c["a"])({},Object(l["c"])(["showDialog","showCustomersError"])),{},{isStepCompleted:function(e){return void 0!==e&&""===e.exitMessage},isStepError:function(e){return void 0===e||""===e.exitMessage},isPurchaseConvertComplete:function(e){var t=!1;return e.forEach((function(e){"발주 변환"===e.stepName&&(t="COMPLETED"===e.exitCode)})),t},getHistoryList:function(){var e=this;this.$http.get("api/batchJobExecutions?page=0&size=1000&sort=createTime,desc").then((function(t){return e.items=t.data._embedded.batchJobExecutions})).catch((function(t){return e.showDialog({title:"에러 상세 정보",message:t.message})}))},downloadPurchaseOrder:function(e){var t=this;this.$http.get("api/purchase-order/"+e,{responseType:"blob"}).then((function(e){return d(e,"구매 발주.zip")})).catch((function(e){return t.showDialog({title:"에러 상세 정보",message:e.message})}))},statusTranslate:function(e){switch(e){case"COMPLETED":return"완료";case"FAILED":return"실패";default:return e}},getJobSteps:function(e){return this.jobSteps.find((function(t){return t.jobName===e})).steps}}),data:function(){return{jobSteps:[{jobName:"전체",steps:["초기화","품목 다운로드","거래처 다운로드","수주 다운로드","데이터 수집","거래처 체크","품목 변환","수주 변환","발주 변환","품목 업로드","수주 업로드"]},{jobName:"품목 등록",steps:["초기화","품목 다운로드","데이터 수집","품목 변환","품목 업로드"]},{jobName:"거래처 확인",steps:["초기화","거래처 다운로드","데이터 수집","거래처 체크"]},{jobName:"수주 등록",steps:["초기화","품목 다운로드","거래처 다운로드","수주 다운로드","데이터 수집","거래처 체크","품목 변환","수주 변환","품목 업로드","수주 업로드"]},{jobName:"발주 변환",steps:["초기화","품목 다운로드","데이터 수집","발주 변환"]}],items:[],expanded:[],headers:[{text:"배치 번호",align:"center"},{text:"배치 종류",align:"center"},{text:"생성 시간",align:"center"},{text:"시작 시간",align:"center"},{text:"종료 시간",align:"center"},{text:"실행 결과",align:"center"},{text:"발주 데이터",align:"center",sortable:!1},{text:"스텝",align:"center",value:"data-table-expand",sortable:!1}]}}},ae=te,ne=a("cc20"),oe=a("8fea"),re=a("ce7e"),se=a("7e85"),ie=a("9c54"),ce=a("56a4"),le=a("71d9"),ue=a("2a7f"),de=Object(m["a"])(ae,s,i,!1,null,"2f947f1b",null),pe=de.exports;b()(de,{VChip:ne["a"],VContainer:I["a"],VDataTable:oe["a"],VDivider:re["a"],VIcon:L["a"],VSpacer:D["a"],VStepper:se["a"],VStepperHeader:ie["a"],VStepperStep:ce["a"],VToolbar:le["a"],VToolbarTitle:ue["a"]});var ge={name:"App",components:{History:pe},data:function(){return{}}},fe=ge,ve=a("7496"),me=a("f6c4"),he=Object(m["a"])(fe,o,r,!1,null,null,null),be=he.exports;b()(he,{VApp:ve["a"],VMain:me["a"]});var xe=a("f309");a("5363");n["default"].use(xe["a"]);var _e=new xe["a"]({icons:{iconfont:"mdi"}}),ye=a("bc3a"),we=a.n(ye),De=a("2106"),Ce=a.n(De);a("caad"),a("2532");n["default"].use(l["a"]);var Ve=new l["a"].Store({state:{messageDialog:{show:!1,title:"",message:"",jobExecutionId:""}},getters:{getMessageDialog:function(e){return e.messageDialog},isCustomersDownload:function(e){var t=!1;return null!==e.messageDialog.message&&(t=e.messageDialog.message.includes("미등록")),t}},mutations:{showDialog:function(e,t){e.messageDialog.title=t.title,e.messageDialog.message=t.message,e.messageDialog.show=!0},showCustomersError:function(e,t){var a=t._links.jobExecutionId.href;e.messageDialog.jobExecutionId=a.substring(a.lastIndexOf("/")+1),e.messageDialog.title="에러 상세 정보",e.messageDialog.message=t.exitMessage.replace(":","\n"),e.messageDialog.show=!0}},actions:{},modules:{}});n["default"].config.productionTip=!1,n["default"].use(Ce.a,we.a),new n["default"]({vuetify:_e,store:Ve,render:function(e){return e(be)}}).$mount("#app")}});
//# sourceMappingURL=app.02330c2e.js.map